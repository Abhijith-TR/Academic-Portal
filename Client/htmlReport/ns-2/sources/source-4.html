


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > PostgresFacultyDAO</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">org.abhijith.dal</a>
</div>

<h1>Coverage Summary for Class: PostgresFacultyDAO (org.abhijith.dal)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">PostgresFacultyDAO</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (16/16)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (253/253)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package org.abhijith.dal;
&nbsp;
&nbsp;import org.abhijith.daoInterfaces.FacultyDAO;
&nbsp;
&nbsp;import java.sql.PreparedStatement;
&nbsp;import java.sql.ResultSet;
&nbsp;import java.util.ArrayList;
&nbsp;
&nbsp;public class PostgresFacultyDAO extends PostgresCommonDAO implements FacultyDAO {
&nbsp;    public PostgresFacultyDAO( String connectionURL, String username, String password ) {
<b class="fc">&nbsp;        super( connectionURL, username, password );</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public boolean insertCourseOffering( String courseCode, int currentYear, int currentSemester, String departmentID, String facultyID ) {
&nbsp;        try {
<b class="fc">&nbsp;            if ( courseCode == null || currentSemester &lt;= 0 || currentYear &lt; 0 || departmentID == null || facultyID == null )</b>
<b class="fc">&nbsp;                return false;</b>
<b class="fc">&nbsp;            courseCode = courseCode.toUpperCase();</b>
<b class="fc">&nbsp;            departmentID = departmentID.toUpperCase();</b>
<b class="fc">&nbsp;            facultyID = facultyID.toUpperCase();</b>
&nbsp;
&nbsp;            // SQL query to insert a course into the course catalog
<b class="fc">&nbsp;            PreparedStatement insertCourseQuery = databaseConnection.prepareStatement( &quot;INSERT INTO course_offerings(course_code, faculty_id, year, semester, department_id) VALUES (?, ?, ?, ?, ?)&quot; );</b>
<b class="fc">&nbsp;            insertCourseQuery.setString( 1, courseCode );</b>
<b class="fc">&nbsp;            insertCourseQuery.setString( 2, facultyID );</b>
<b class="fc">&nbsp;            insertCourseQuery.setInt( 3, currentYear );</b>
<b class="fc">&nbsp;            insertCourseQuery.setInt( 4, currentSemester );</b>
<b class="fc">&nbsp;            insertCourseQuery.setString( 5, departmentID );</b>
&nbsp;
&nbsp;            // Returns 1 if a new course was inserted, 0 otherwise
<b class="fc">&nbsp;            int insertCourseQueryResult = insertCourseQuery.executeUpdate();</b>
<b class="fc">&nbsp;            return insertCourseQueryResult == 1;</b>
<b class="fc">&nbsp;        } catch ( Exception error ) {</b>
<b class="fc">&nbsp;            System.out.println( &quot;Error. Please verify that the course is not already offered&quot; );</b>
<b class="fc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public String getDepartment( String facultyID ) {
&nbsp;        try {
<b class="fc">&nbsp;            if ( facultyID == null ) return &quot;&quot;;</b>
<b class="fc">&nbsp;            facultyID = facultyID.toUpperCase();</b>
&nbsp;
&nbsp;            // SQL query to retrieve the department ID of the faculty from the database
<b class="fc">&nbsp;            PreparedStatement getDepartmentQuery = databaseConnection.prepareStatement( &quot;SELECT department_id FROM faculty WHERE faculty_id = ?&quot; );</b>
<b class="fc">&nbsp;            getDepartmentQuery.setString( 1, facultyID );</b>
<b class="fc">&nbsp;            ResultSet getDepartmentQueryResult = getDepartmentQuery.executeQuery();</b>
<b class="fc">&nbsp;            getDepartmentQueryResult.next();</b>
&nbsp;
&nbsp;            // Gets the department ID of the faculty from the ResultSet ( if the professor ID is valid )
<b class="fc">&nbsp;            return getDepartmentQueryResult.getString( 1 );</b>
<b class="fc">&nbsp;        } catch ( Exception error ) {</b>
<b class="fc">&nbsp;            System.out.println( &quot;Faculty ID not found in database.&quot; );</b>
<b class="fc">&nbsp;            return &quot;&quot;;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public boolean setCGCriteria( String facultyID, String courseCode, double minimumCGPA, int[] currentSession, String departmentID ) {
&nbsp;        try {
<b class="fc">&nbsp;            if ( facultyID == null || courseCode == null || minimumCGPA &lt; 0 || minimumCGPA &gt; 10 || currentSession == null || departmentID == null )</b>
<b class="fc">&nbsp;                return false;</b>
<b class="fc">&nbsp;            if ( currentSession.length != 2 || currentSession[0] &lt; 0 || currentSession[1] &lt;= 0 ) return false;</b>
<b class="fc">&nbsp;            facultyID = facultyID.toUpperCase();</b>
<b class="fc">&nbsp;            courseCode = courseCode.toUpperCase();</b>
<b class="fc">&nbsp;            departmentID = departmentID.toUpperCase();</b>
&nbsp;
&nbsp;            // SQL query to update the CG requirements of the corresponding offering in the database
<b class="fc">&nbsp;            PreparedStatement setCGQuery = databaseConnection.prepareStatement( &quot;UPDATE course_offerings SET cgpa_criteria = ? WHERE course_code = ? AND faculty_id = ? AND year = ? AND semester = ? AND department_id = ?&quot; );</b>
<b class="fc">&nbsp;            setCGQuery.setDouble( 1, minimumCGPA );</b>
<b class="fc">&nbsp;            setCGQuery.setString( 2, courseCode );</b>
<b class="fc">&nbsp;            setCGQuery.setString( 3, facultyID );</b>
<b class="fc">&nbsp;            setCGQuery.setInt( 4, currentSession[0] );</b>
<b class="fc">&nbsp;            setCGQuery.setInt( 5, currentSession[1] );</b>
<b class="fc">&nbsp;            setCGQuery.setString( 6, departmentID );</b>
<b class="fc">&nbsp;            setCGQuery.executeUpdate();</b>
&nbsp;
&nbsp;            // Returns true if the query was successful and the CG criteria was updated ( if it was change, there is no difference )
<b class="fc">&nbsp;            return true;</b>
<b class="fc">&nbsp;        } catch ( Exception error ) {</b>
<b class="fc">&nbsp;            System.out.println( &quot;Database Error. Please verify that the course offering exists in the current session&quot; );</b>
<b class="fc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public boolean setInstructorPrerequisites( String departmentID, String courseCode, String[][] prerequisites, int[] currentSession ) {
&nbsp;        try {
<b class="fc">&nbsp;            if ( departmentID == null || courseCode == null || prerequisites == null || currentSession == null )</b>
<b class="fc">&nbsp;                return false;</b>
<b class="fc">&nbsp;            if ( currentSession.length != 2 || currentSession[0] &lt; 0 || currentSession[1] &lt;= 0 ) return false;</b>
<b class="fc">&nbsp;            departmentID = departmentID.toUpperCase();</b>
<b class="fc">&nbsp;            courseCode = courseCode.toUpperCase();</b>
&nbsp;
&nbsp;            // If prerequisites already exist for this course offering, those are dropped first
<b class="fc">&nbsp;            int currentYear     = currentSession[0];</b>
<b class="fc">&nbsp;            int currentSemester = currentSession[1];</b>
<b class="fc">&nbsp;            int successStatus   = 1;</b>
&nbsp;
&nbsp;            // SQL query to drop the prerequisites for this course first
<b class="fc">&nbsp;            PreparedStatement dropQuery = databaseConnection.prepareStatement( &quot;DELETE FROM instructor_prerequisites WHERE course_code = ? AND year = ? AND semester = ? AND department_id = ?&quot; );</b>
<b class="fc">&nbsp;            dropQuery.setString( 1, courseCode );</b>
<b class="fc">&nbsp;            dropQuery.setInt( 2, currentYear );</b>
<b class="fc">&nbsp;            dropQuery.setInt( 3, currentSemester );</b>
<b class="fc">&nbsp;            dropQuery.setString( 4, departmentID );</b>
<b class="fc">&nbsp;            dropQuery.executeUpdate();</b>
&nbsp;
&nbsp;            // Set the prerequisites again
<b class="fc">&nbsp;            PreparedStatement insertQuery = databaseConnection.prepareStatement( &quot;INSERT INTO instructor_prerequisites VALUES (?, ?, ?, ?, ?, ?, ?)&quot; );</b>
<b class="fc">&nbsp;            insertQuery.setString( 1, courseCode );</b>
<b class="fc">&nbsp;            insertQuery.setInt( 2, currentYear );</b>
<b class="fc">&nbsp;            insertQuery.setInt( 3, currentSemester );</b>
<b class="fc">&nbsp;            insertQuery.setString( 4, departmentID );</b>
&nbsp;
&nbsp;            // j denotes the type i.e., the group of offerings
<b class="fc">&nbsp;            int j = 1;</b>
&nbsp;
&nbsp;            // We iterate through all the prerequisites
<b class="fc">&nbsp;            for ( String[] groups : prerequisites ) {</b>
&nbsp;
&nbsp;                // If an invalid length has somehow entered the function
&nbsp;                // All arrays must be strings of even length where the even parity items are courses and odd parity items are course grades
<b class="fc">&nbsp;                if ( groups.length % 2 == 1 ) {</b>
<b class="fc">&nbsp;                    successStatus = 0;</b>
<b class="fc">&nbsp;                    continue;</b>
&nbsp;                }
&nbsp;
&nbsp;                // Iterate through all the courses entered
<b class="fc">&nbsp;                for ( int i = 0; i &lt; groups.length; i += 2 ) {</b>
<b class="fc">&nbsp;                    insertQuery.setString( 5, groups[i].toUpperCase() );</b>
<b class="fc">&nbsp;                    int gradeCriteria = Integer.parseInt( groups[i + 1] );</b>
&nbsp;
&nbsp;                    // The grade checking is done to ensure that the database does not complain
<b class="fc">&nbsp;                    if ( gradeCriteria &gt; 10 || gradeCriteria &lt; 0 ) continue;</b>
<b class="fc">&nbsp;                    insertQuery.setInt( 6, gradeCriteria );</b>
<b class="fc">&nbsp;                    insertQuery.setInt( 7, j );</b>
&nbsp;
&nbsp;                    // Success status = 1 is delivered only if ALL the entries were inserted into the database
<b class="fc">&nbsp;                    successStatus &amp;= insertQuery.executeUpdate();</b>
&nbsp;                }
<b class="fc">&nbsp;                j++;</b>
&nbsp;            }
&nbsp;
<b class="fc">&nbsp;            return successStatus == 1;</b>
<b class="fc">&nbsp;        } catch ( Exception error ) {</b>
<b class="fc">&nbsp;            System.out.println( &quot;Database Error. Please verify details before trying again&quot; );</b>
<b class="fc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public boolean dropCourseOffering( String facultyID, String courseCode, int currentYear, int currentSemester, String departmentID ) {
&nbsp;        try {
<b class="fc">&nbsp;            if ( facultyID == null || courseCode == null || currentSemester &lt;= 0 || currentYear &lt; 0 || departmentID == null ) return false;</b>
<b class="fc">&nbsp;            facultyID = facultyID.toUpperCase();</b>
<b class="fc">&nbsp;            courseCode = courseCode.toUpperCase();</b>
<b class="fc">&nbsp;            departmentID = departmentID.toUpperCase();</b>
&nbsp;
&nbsp;            // SQL query to drop the course from the table if it exists ( note that it also drops all students of the course )
<b class="fc">&nbsp;            PreparedStatement dropOfferingQuery = databaseConnection.prepareStatement( &quot;DELETE FROM course_offerings WHERE faculty_id = ? AND course_code = ? AND year = ? AND semester = ? AND department_id = ?&quot; );</b>
<b class="fc">&nbsp;            dropOfferingQuery.setString( 1, facultyID );</b>
<b class="fc">&nbsp;            dropOfferingQuery.setString( 2, courseCode );</b>
<b class="fc">&nbsp;            dropOfferingQuery.setInt( 3, currentYear );</b>
<b class="fc">&nbsp;            dropOfferingQuery.setInt( 4, currentSemester );</b>
<b class="fc">&nbsp;            dropOfferingQuery.setString( 5, departmentID );</b>
&nbsp;
&nbsp;            // If the course was dropped successfully return 1. If not return 0
<b class="fc">&nbsp;            return dropOfferingQuery.executeUpdate() == 1;</b>
<b class="fc">&nbsp;        } catch ( Exception error ) {</b>
<b class="fc">&nbsp;            System.out.println( &quot;Database Error. Please try again later&quot; );</b>
<b class="fc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public boolean checkIfOfferedBySelf( String facultyID, String courseCode, int currentYear, int currentSemester, String departmentID ) {
&nbsp;        try {
<b class="fc">&nbsp;            if ( facultyID == null || courseCode == null || currentSemester &lt;= 0 || currentYear &lt; 0 || departmentID == null ) return false;</b>
<b class="fc">&nbsp;            facultyID = facultyID.toUpperCase();</b>
<b class="fc">&nbsp;            courseCode = courseCode.toUpperCase();</b>
<b class="fc">&nbsp;            departmentID = departmentID.toUpperCase();</b>
&nbsp;
&nbsp;            // SQL query to fetch the course with these parameters if it exists
<b class="fc">&nbsp;            PreparedStatement checkOfferingQuery = databaseConnection.prepareStatement( &quot;SELECT course_code FROM course_offerings WHERE faculty_id = ? AND course_code = ? AND year = ? AND semester = ? AND department_id = ?&quot; );</b>
<b class="fc">&nbsp;            checkOfferingQuery.setString( 1, facultyID );</b>
<b class="fc">&nbsp;            checkOfferingQuery.setString( 2, courseCode );</b>
<b class="fc">&nbsp;            checkOfferingQuery.setInt( 3, currentYear );</b>
<b class="fc">&nbsp;            checkOfferingQuery.setInt( 4, currentSemester );</b>
<b class="fc">&nbsp;            checkOfferingQuery.setString( 5, departmentID );</b>
<b class="fc">&nbsp;            ResultSet checkOfferingQueryResult = checkOfferingQuery.executeQuery();</b>
&nbsp;
&nbsp;            // True only if there exists a course with these properties
<b class="fc">&nbsp;            return checkOfferingQueryResult.next();</b>
<b class="fc">&nbsp;        } catch ( Exception error ) {</b>
<b class="fc">&nbsp;            System.out.println( &quot;Database Error. Please try again later&quot; );</b>
<b class="fc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public boolean setCourseCategory( String courseCode, int currentYear, int currentSemester, String courseCategory, String department, int[] years, String offeringDepartment ) {
&nbsp;        try {
<b class="fc">&nbsp;            if ( courseCode == null || currentYear &lt; 0 || currentSemester &lt;= 0 || courseCategory == null || department == null || years == null || offeringDepartment == null )</b>
<b class="fc">&nbsp;                return false;</b>
<b class="fc">&nbsp;            courseCode = courseCode.toUpperCase();</b>
<b class="fc">&nbsp;            courseCategory = courseCategory.toUpperCase();</b>
<b class="fc">&nbsp;            department = department.toUpperCase();</b>
<b class="fc">&nbsp;            offeringDepartment = offeringDepartment.toUpperCase();</b>
&nbsp;
&nbsp;            // SQL query to insert all the entries into the database
<b class="fc">&nbsp;            PreparedStatement insertCourseQuery = databaseConnection.prepareStatement( &quot;INSERT INTO course_category VALUES (?, ?, ?, ?, ?, ?, ?)&quot; );</b>
<b class="fc">&nbsp;            insertCourseQuery.setString( 1, courseCode );</b>
<b class="fc">&nbsp;            insertCourseQuery.setInt( 2, currentYear );</b>
<b class="fc">&nbsp;            insertCourseQuery.setInt( 3, currentSemester );</b>
<b class="fc">&nbsp;            insertCourseQuery.setString( 4, offeringDepartment );</b>
<b class="fc">&nbsp;            insertCourseQuery.setString( 5, courseCategory );</b>
<b class="fc">&nbsp;            insertCourseQuery.setString( 7, department );</b>
&nbsp;
&nbsp;            // Iterate through all the years and insert the entries for the corresponding years into the database
<b class="fc">&nbsp;            boolean insertResult = true;</b>
<b class="fc">&nbsp;            for ( int year : years ) {</b>
<b class="fc">&nbsp;                if ( year &lt; 0 ) {</b>
<b class="fc">&nbsp;                    insertResult = false;</b>
<b class="fc">&nbsp;                    continue;</b>
&nbsp;                }
<b class="fc">&nbsp;                insertCourseQuery.setInt( 6, year );</b>
<b class="fc">&nbsp;                insertCourseQuery.executeUpdate();</b>
&nbsp;            }
&nbsp;
&nbsp;            // If all the insert queries were executed without errors, return true
<b class="fc">&nbsp;            return insertResult;</b>
<b class="fc">&nbsp;        } catch ( Exception error ) {</b>
<b class="fc">&nbsp;            System.out.println( &quot;Database error. Please try again later&quot; );</b>
<b class="fc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public boolean verifyCore( String courseCode, String departmentID, int year ) {
&nbsp;        try {
<b class="fc">&nbsp;            if ( courseCode == null || departmentID == null || year &lt; 0 ) return false;</b>
<b class="fc">&nbsp;            courseCode = courseCode.toUpperCase();</b>
<b class="fc">&nbsp;            departmentID = departmentID.toUpperCase();</b>
&nbsp;
&nbsp;            // From the table try and find the corresponding course code and the department
<b class="fc">&nbsp;            PreparedStatement checkCoreCourseQuery = databaseConnection.prepareStatement( &quot;SELECT * FROM core_courses WHERE course_code = ? AND department_id = ? AND batch = ?&quot; );</b>
<b class="fc">&nbsp;            checkCoreCourseQuery.setString( 1, courseCode );</b>
<b class="fc">&nbsp;            checkCoreCourseQuery.setString( 2, departmentID );</b>
<b class="fc">&nbsp;            checkCoreCourseQuery.setInt( 3, year );</b>
<b class="fc">&nbsp;            ResultSet checkCoreCourseQueryResult = checkCoreCourseQuery.executeQuery();</b>
&nbsp;
&nbsp;            // If even a single record is returned, then you have found a course with the corresponding batch from the table
<b class="fc">&nbsp;            return checkCoreCourseQueryResult.next();</b>
<b class="fc">&nbsp;        } catch ( Exception error ) {</b>
<b class="fc">&nbsp;            System.out.println( &quot;Database error. Please try again later&quot; );</b>
<b class="fc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public String[][] getGradesOfCourse( String courseCode, int year, int semester, String departmentID ) {
&nbsp;        try {
<b class="fc">&nbsp;            if ( courseCode == null || year &lt; 0 || semester &lt;= 0 || departmentID == null ) return new String[][]{};</b>
<b class="fc">&nbsp;            courseCode = courseCode.toUpperCase();</b>
<b class="fc">&nbsp;            departmentID = departmentID.toUpperCase();</b>
&nbsp;
&nbsp;            // SQL query to fetch the grades of a particular course from the database
<b class="fc">&nbsp;            PreparedStatement getGradesQuery = databaseConnection.prepareStatement( &quot;SELECT entry_number, grade FROM student_course_registration WHERE course_code = ? AND year = ? AND semester = ? AND department_id = ? ORDER BY entry_number&quot; );</b>
<b class="fc">&nbsp;            getGradesQuery.setString( 1, courseCode );</b>
<b class="fc">&nbsp;            getGradesQuery.setInt( 2, year );</b>
<b class="fc">&nbsp;            getGradesQuery.setInt( 3, semester );</b>
<b class="fc">&nbsp;            getGradesQuery.setString( 4, departmentID );</b>
<b class="fc">&nbsp;            ResultSet getGradesQueryResult = getGradesQuery.executeQuery();</b>
&nbsp;
&nbsp;            // Once the results have been fetched, they must be converted to the proper return form
<b class="fc">&nbsp;            ArrayList&lt;String[]&gt; records = new ArrayList&lt;&gt;();</b>
&nbsp;
&nbsp;            // The ResultSet contains entry numbers and grades
<b class="fc">&nbsp;            while ( getGradesQueryResult.next() ) {</b>
<b class="fc">&nbsp;                String entry_number = getGradesQueryResult.getString( 1 );</b>
<b class="fc">&nbsp;                String grade        = getGradesQueryResult.getString( 2 );</b>
<b class="fc">&nbsp;                records.add( new String[]{ entry_number, grade } );</b>
<b class="fc">&nbsp;            }</b>
<b class="fc">&nbsp;            return records.toArray( new String[records.size()][] );</b>
<b class="fc">&nbsp;        } catch ( Exception error ) {</b>
<b class="fc">&nbsp;            System.out.println( &quot;Database Error. Please try again later&quot; );</b>
<b class="fc">&nbsp;            return new String[][]{};</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public String[][] getCourseEnrollmentsList( String courseCode, int year, int semester, String departmentID ) {
&nbsp;        try {
<b class="fc">&nbsp;            if ( courseCode == null || year &lt; 0 || semester &lt;= 0 ) return new String[][]{};</b>
<b class="fc">&nbsp;            courseCode = courseCode.toUpperCase();</b>
&nbsp;
&nbsp;            // SQL query to get the name and entry number for this particular course offeirng
<b class="fc">&nbsp;            PreparedStatement getEnrollmentsQuery = databaseConnection.prepareStatement( &quot;SELECT name, entry_number FROM student_course_registration NATURAL JOIN student WHERE course_code = ? AND year = ? AND semester = ? AND department_id = ?  ORDER BY entry_number&quot; );</b>
<b class="fc">&nbsp;            getEnrollmentsQuery.setString( 1, courseCode );</b>
<b class="fc">&nbsp;            getEnrollmentsQuery.setInt( 2, year );</b>
<b class="fc">&nbsp;            getEnrollmentsQuery.setInt( 3, semester );</b>
<b class="fc">&nbsp;            getEnrollmentsQuery.setString( 4, departmentID );</b>
<b class="fc">&nbsp;            ResultSet getEnrollmentsQueryResult = getEnrollmentsQuery.executeQuery();</b>
&nbsp;
&nbsp;            // Converting the result set that was obtained
<b class="fc">&nbsp;            ArrayList&lt;String[]&gt; records = new ArrayList&lt;&gt;();</b>
<b class="fc">&nbsp;            while ( getEnrollmentsQueryResult.next() ) {</b>
<b class="fc">&nbsp;                String name        = getEnrollmentsQueryResult.getString( 1 );</b>
<b class="fc">&nbsp;                String entryNumber = getEnrollmentsQueryResult.getString( 2 );</b>
<b class="fc">&nbsp;                records.add( new String[]{ name, entryNumber } );</b>
<b class="fc">&nbsp;            }</b>
<b class="fc">&nbsp;            return records.toArray( new String[records.size()][] );</b>
<b class="fc">&nbsp;        } catch ( Exception error ) {</b>
<b class="fc">&nbsp;            System.out.println( &quot;Database Error. Please try again later&quot; );</b>
<b class="fc">&nbsp;            return new String[][]{};</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public String[] getListOfStudents( String courseCode, int year, int semester, String departmentID ) {
&nbsp;        try {
<b class="fc">&nbsp;            if ( courseCode == null || year &lt; 0 || semester &lt;= 0 || departmentID == null ) return new String[]{};</b>
<b class="fc">&nbsp;            courseCode = courseCode.toUpperCase();</b>
<b class="fc">&nbsp;            departmentID = departmentID.toUpperCase();</b>
&nbsp;
&nbsp;            // A list to store all the students enrolled in this course
<b class="fc">&nbsp;            ArrayList&lt;String&gt; listOfStudents = new ArrayList&lt;&gt;();</b>
&nbsp;
&nbsp;            // SQL query to retrieve the list of students from the database
<b class="fc">&nbsp;            PreparedStatement getStudentsQuery = databaseConnection.prepareStatement( &quot;SELECT entry_number FROM student_course_registration WHERE course_code = ? AND year = ? AND semester = ? AND department_id = ?&quot; );</b>
<b class="fc">&nbsp;            getStudentsQuery.setString( 1, courseCode );</b>
<b class="fc">&nbsp;            getStudentsQuery.setInt( 2, year );</b>
<b class="fc">&nbsp;            getStudentsQuery.setInt( 3, semester );</b>
<b class="fc">&nbsp;            getStudentsQuery.setString( 4, departmentID );</b>
<b class="fc">&nbsp;            ResultSet getStudentsQueryResult = getStudentsQuery.executeQuery();</b>
&nbsp;
&nbsp;            // Now get all the students from the result set into the array that was created above
<b class="fc">&nbsp;            while ( getStudentsQueryResult.next() ) {</b>
<b class="fc">&nbsp;                String entryNumber = getStudentsQueryResult.getString( 1 );</b>
<b class="fc">&nbsp;                listOfStudents.add( entryNumber );</b>
<b class="fc">&nbsp;            }</b>
&nbsp;            // Return it in the form of a string array
<b class="fc">&nbsp;            return listOfStudents.toArray( new String[listOfStudents.size()] );</b>
<b class="fc">&nbsp;        } catch ( Exception error ) {</b>
<b class="fc">&nbsp;            System.out.println( &quot;Database Error. Please try again later&quot; );</b>
<b class="fc">&nbsp;            return new String[]{};</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public boolean isCurrentEventOffering( int currentYear, int currentSemester ) {
&nbsp;        try {
<b class="fc">&nbsp;            if ( currentYear &lt; 0 || currentSemester &lt;= 0 ) return false;</b>
&nbsp;
&nbsp;            // SQL query to check if the current event in the given session is enrolling
<b class="fc">&nbsp;            PreparedStatement offeringCheckQuery = databaseConnection.prepareStatement( &quot;SELECT * FROM current_year_and_semester WHERE year = ? AND semester = ? AND current_event = &#39;OFFERING&#39;&quot; );</b>
<b class="fc">&nbsp;            offeringCheckQuery.setInt( 1, currentYear );</b>
<b class="fc">&nbsp;            offeringCheckQuery.setInt( 2, currentSemester );</b>
<b class="fc">&nbsp;            ResultSet offeringCheckQueryResult = offeringCheckQuery.executeQuery();</b>
&nbsp;
&nbsp;            // If there exists such a record, it implies that the current session is offering
<b class="fc">&nbsp;            return offeringCheckQueryResult.next();</b>
<b class="fc">&nbsp;        } catch ( Exception error ) {</b>
<b class="fc">&nbsp;            System.out.println( &quot;Database Error. Please try again later&quot; );</b>
<b class="fc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public boolean isCurrentEventGradeSubmission( int currentYear, int currentSemester ) {
&nbsp;        try {
<b class="fc">&nbsp;            if ( currentYear &lt; 0 || currentSemester &lt;= 0 ) return false;</b>
&nbsp;
&nbsp;            // SQL query to check if the current event in the given session is enrolling
<b class="fc">&nbsp;            PreparedStatement offeringCheckQuery = databaseConnection.prepareStatement( &quot;SELECT * FROM current_year_and_semester WHERE year = ? AND semester = ? AND current_event = &#39;GRADE SUBMISSION&#39;&quot; );</b>
<b class="fc">&nbsp;            offeringCheckQuery.setInt( 1, currentYear );</b>
<b class="fc">&nbsp;            offeringCheckQuery.setInt( 2, currentSemester );</b>
<b class="fc">&nbsp;            ResultSet offeringCheckQueryResult = offeringCheckQuery.executeQuery();</b>
&nbsp;
&nbsp;            // If there exists such a record, it implies that the current session is offering
<b class="fc">&nbsp;            return offeringCheckQueryResult.next();</b>
<b class="fc">&nbsp;        } catch ( Exception error ) {</b>
<b class="fc">&nbsp;            System.out.println( &quot;Database Error. Please try again later&quot; );</b>
<b class="fc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public boolean uploadCourseGrades( String courseCode, int year, int semester, String offeringDepartment, String[] listOfStudents, String[] listOfGrades ) {
&nbsp;        try {
<b class="fc">&nbsp;            if ( courseCode == null || year &lt; 0 || semester &lt;= 0 || listOfGrades == null || listOfStudents == null || offeringDepartment == null || listOfStudents.length != listOfGrades.length ) return false;</b>
<b class="fc">&nbsp;            courseCode = courseCode.toUpperCase();</b>
<b class="fc">&nbsp;            offeringDepartment = offeringDepartment.toUpperCase();</b>
&nbsp;
&nbsp;            // The database requires the course codes to be in uppercase
<b class="fc">&nbsp;            courseCode = courseCode.toUpperCase();</b>
&nbsp;
&nbsp;            // Construct the SQL query that will be used to update course grades
<b class="fc">&nbsp;            PreparedStatement uploadGradeQuery = databaseConnection.prepareStatement( &quot;UPDATE student_course_registration SET grade = ? WHERE entry_number = ? AND  course_code = ? AND year = ? AND semester = ? AND department_id = ?&quot; );</b>
<b class="fc">&nbsp;            uploadGradeQuery.setString( 3, courseCode );</b>
<b class="fc">&nbsp;            uploadGradeQuery.setInt( 4, year );</b>
<b class="fc">&nbsp;            uploadGradeQuery.setInt( 5, semester );</b>
<b class="fc">&nbsp;            uploadGradeQuery.setString( 6, offeringDepartment );</b>
&nbsp;
&nbsp;            // Now iterate through the list of students and grades and set the grade and entry number of the student
<b class="fc">&nbsp;            boolean insertResult = true;</b>
<b class="fc">&nbsp;            for ( int i = 0; i &lt; listOfStudents.length; i++ ) {</b>
<b class="fc">&nbsp;                if ( listOfGrades[i] == null || listOfStudents[i] == null ) {</b>
<b class="fc">&nbsp;                    insertResult = false;</b>
<b class="fc">&nbsp;                    continue;</b>
&nbsp;                }
<b class="fc">&nbsp;                uploadGradeQuery.setString( 1, listOfGrades[i] );</b>
<b class="fc">&nbsp;                uploadGradeQuery.setString( 2, listOfStudents[i].toUpperCase() );</b>
<b class="fc">&nbsp;                uploadGradeQuery.executeUpdate();</b>
&nbsp;            }
<b class="fc">&nbsp;            return insertResult;</b>
<b class="fc">&nbsp;        } catch ( Exception error ) {</b>
<b class="fc">&nbsp;            System.out.println( &quot;Database Error. Please verify that all grades are valid&quot; );</b>
<b class="fc">&nbsp;            return false;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public boolean isCourseAlreadyOffered( String courseCode, int currentYear, int currentSemester, String offeringDepartment ) {
&nbsp;        try {
<b class="fc">&nbsp;            if ( courseCode == null || currentYear &lt; 0 || currentSemester &lt;= 0 || offeringDepartment == null ) return true;</b>
<b class="fc">&nbsp;            courseCode = courseCode.toUpperCase();</b>
<b class="fc">&nbsp;            offeringDepartment = offeringDepartment.toUpperCase();</b>
&nbsp;
&nbsp;            // SQL query to check if this course has been offered by your department already
<b class="fc">&nbsp;            PreparedStatement checkOfferingQuery = databaseConnection.prepareStatement( &quot;SELECT * FROM course_offerings WHERE course_code = ? AND year = ? AND semester = ? AND department_id = ?&quot; );</b>
<b class="fc">&nbsp;            checkOfferingQuery.setString( 1, courseCode );</b>
<b class="fc">&nbsp;            checkOfferingQuery.setInt( 2, currentYear );</b>
<b class="fc">&nbsp;            checkOfferingQuery.setInt( 3, currentSemester );</b>
<b class="fc">&nbsp;            checkOfferingQuery.setString( 4, offeringDepartment );</b>
<b class="fc">&nbsp;            ResultSet checkOfferingQueryResult = checkOfferingQuery.executeQuery();</b>
&nbsp;
&nbsp;            // If the query returns a row, then the course has already been offered
<b class="fc">&nbsp;            return checkOfferingQueryResult.next();</b>
<b class="fc">&nbsp;        } catch ( Exception error ) {</b>
<b class="fc">&nbsp;            System.out.println( &quot;Database Error. Please try again later&quot; );</b>
<b class="fc">&nbsp;            return true;</b>
&nbsp;        }
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-02-21 11:47</div>
</div>
</body>
</html>
